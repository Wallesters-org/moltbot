/**
 * Бърза Работна Памет - Типове и модели
 *
 * Дефинира основните типове за системата за управление на паметта,
 * включително документи, сегменти, векторни представяния и резултати от търсене.
 */

/** Поддържани формати за качване */
export type ПоддържанФормат = "pdf" | "json" | "image" | "text";

/** Състояние на обработка на документ */
export type СъстояниеНаОбработка = "изчакване" | "обработка" | "завършено" | "грешка";

/** Тип на източника на документ */
export type ТипИзточник = "камера" | "качване" | "сканиране" | "текст";

/** Метаданни за документ */
export interface ДокументМетаданни {
  /** Уникален идентификатор */
  идентификатор: string;
  /** Име на файла */
  имеНаФайл: string;
  /** Формат на файла */
  формат: ПоддържанФормат;
  /** Размер в байтове */
  размер: number;
  /** Дата на създаване */
  създаденНа: Date;
  /** Дата на последна промяна */
  променен: Date;
  /** Източник на документа */
  източник: ТипИзточник;
  /** Допълнителни тагове */
  тагове: string[];
}

/** Текстов сегмент от документ */
export interface ТекстовСегмент {
  /** Уникален идентификатор на сегмента */
  идентификатор: string;
  /** Идентификатор на родителски документ */
  документИд: string;
  /** Текстово съдържание */
  съдържание: string;
  /** Начална позиция в оригиналния текст */
  началнаПозиция: number;
  /** Крайна позиция в оригиналния текст */
  крайнаПозиция: number;
  /** Ниво на вложеност */
  ниво: number;
  /** Тип на сегмента */
  тип: "заглавие" | "параграф" | "списък" | "таблица" | "код";
}

/** Векторно представяне на сегмент */
export interface ВекторноПредставяне {
  /** Идентификатор на сегмента */
  сегментИд: string;
  /** Векторни стойности */
  вектор: number[];
  /** Размерност на вектора */
  размерност: number;
  /** Модел използван за генериране */
  модел: string;
  /** Дата на генериране */
  генериранНа: Date;
}

/** Резултат от търсене */
export interface РезултатОтТърсене {
  /** Намерен сегмент */
  сегмент: ТекстовСегмент;
  /** Оценка на сходство (0-1) */
  сходство: number;
  /** Метаданни на документа */
  документ: ДокументМетаданни;
  /** Дали е използван преди */
  използванПреди: boolean;
  /** Дата на последно използване */
  последноИзползване?: Date;
}

/** Конфигурация на паметта */
export interface КонфигурацияНаПамет {
  /** Максимален брой резултати при търсене */
  максРезултати: number;
  /** Минимален праг на сходство */
  прагНаСходство: number;
  /** Път до базата данни */
  пътДоБаза: string;
  /** Модел за embeddings */
  моделЗаВектори: "openai" | "local" | "gemini" | "auto";
  /** Автоматично индексиране */
  автоИндексиране: boolean;
  /** Максимална дължина на сегмент */
  максДължинаСегмент: number;
}

/** OCR резултат */
export interface OCRРезултат {
  /** Извлечен текст */
  текст: string;
  /** Увереност (0-1) */
  увереност: number;
  /** Език на текста */
  език: string;
  /** Области с текст */
  области: OCRОбласт[];
  /** Време за обработка в ms */
  времеЗаОбработка: number;
}

/** OCR област с текст */
export interface OCRОбласт {
  /** Координати на областта */
  координати: {
    x: number;
    y: number;
    ширина: number;
    височина: number;
  };
  /** Текст в областта */
  текст: string;
  /** Увереност за тази област */
  увереност: number;
}

/** Статистика за използване */
export interface СтатистикаЗаИзползване {
  /** Общ брой документи */
  общоДокументи: number;
  /** Общ брой сегменти */
  общоСегменти: number;
  /** Използвана памет в MB */
  използванаПамет: number;
  /** Брой търсения */
  бройТърсения: number;
  /** Последна синхронизация */
  последнаСинхронизация: Date;
}

/** Опции за качване на файл */
export interface ОпцииЗаКачване {
  /** Автоматично OCR за изображения */
  автоOCR: boolean;
  /** Тагове за документа */
  тагове?: string[];
  /** Принудително презаписване */
  презаписване: boolean;
  /** Източник на файла */
  източник: ТипИзточник;
}

/** Резултат от качване */
export interface РезултатОтКачване {
  /** Успех на операцията */
  успех: boolean;
  /** Метаданни на документа */
  документ?: ДокументМетаданни;
  /** Съобщение за грешка */
  грешка?: string;
  /** Брой създадени сегменти */
  бройСегменти: number;
}

/** Сценарий за използване */
export interface Сценарий {
  /** Уникален идентификатор */
  идентификатор: string;
  /** Име на сценария */
  име: string;
  /** Описание */
  описание: string;
  /** Свързани документи */
  документи: string[];
  /** Създаден на */
  създаденНа: Date;
  /** Активен ли е */
  активен: boolean;
}
