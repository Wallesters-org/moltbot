# Бърза Работна Памет

Модул за управление на документи с векторно търсене, OCR сканиране и организация на сценарии.

## Възможности

- **Векторно търсене** - Семантично търсене с косинусно сходство
- **OCR сканиране** - Извличане на текст от изображения (български и английски)
- **Обработка на документи** - Поддръжка на PDF, JSON и изображения
- **Организация на сценарии** - Групиране на документи по случаи на употреба
- **Проследяване на използване** - Маркиране на вече използвана информация

## Структура

```
fast-work-memory/
├── core/
│   ├── analyzer.ts     # Анализатор на документи
│   ├── memory.ts       # Векторна база данни
│   └── segmentator.ts  # Сегментиране на текст
├── models/
│   └── types.ts        # Типове и интерфейси
├── ocr/
│   └── scanner.ts      # OCR скенер
├── upload/
│   └── handler.ts      # Обработка на качвания
├── index.ts            # Главен експорт
└── README.md           # Документация
```

## Използване

### Бързо стартиране

```typescript
import {
  създайПълнаСистема,
  type EmbeddingПровайдър,
} from "./fast-work-memory/index.js";

// Създаване на embedding провайдър
const провайдър: EmbeddingПровайдър = {
  async вградиТекст(текст: string): Promise<number[]> {
    // Интеграция с OpenAI, Gemini или локален модел
    return [];
  },
  async вградиПакет(текстове: string[]): Promise<number[][]> {
    return Promise.all(текстове.map((т) => this.вградиТекст(т)));
  },
};

// Инициализация на системата
const { анализатор, скенер, обработчик } = създайПълнаСистема(провайдър);
```

### Качване на документи

```typescript
// Качване от файл
const резултат = await обработчик.качиОтПът("/път/до/документ.pdf");

// Качване на текст
const текстРезултат = await обработчик.качиТекст(
  "Съдържание на документа...",
  "моят-документ.txt",
);

// Качване от URL
const urlРезултат = await обработчик.качиОтURL(
  "https://пример.com/документ.pdf",
);
```

### Търсене

```typescript
// Семантично търсене
const резултати = await анализатор.търси("ключова фраза", {
  максРезултати: 5,
});

// Търсене с маркиране като използвано
const използвани = await анализатор.търсиИИзползвай(
  "заявка",
  "контекст на използване",
);
```

### Сценарии

```typescript
// Създаване на сценарий
const сценарий = анализатор.създайСценарий(
  "Проект X",
  "Документи свързани с проект X",
);

// Добавяне на документ към сценарий
анализатор.добавиКъмСценарий(сценарий.идентификатор, документИд);

// Автоматична организация
const предложения = await анализатор.автоОрганизирай(документИд);
```

### OCR сканиране

```typescript
// Сканиране на изображение
const ocrРезултат = await скенер.сканирай(буфер);
console.log(ocrРезултат.текст);
console.log(`Увереност: ${ocrРезултат.увереност * 100}%`);

// Промяна на език
скенер.сменяЕзик("bul+eng");

// Промяна на режим
скенер.сменяРежим("точен"); // "бърз" | "точен" | "балансиран"
```

## Типове

### Поддържани формати

- `pdf` - PDF документи
- `json` - JSON файлове
- `image` - Изображения (JPG, PNG, GIF, WebP, BMP)
- `text` - Текстови файлове (TXT, MD, HTML)

### Типове сегменти

- `заглавие` - Заглавия и подзаглавия
- `параграф` - Обикновен текст
- `списък` - Списъчни елементи
- `таблица` - Табличен контент
- `код` - Програмен код

### Източници

- `камера` - Сканирано от камера
- `качване` - Качен файл
- `сканиране` - OCR сканиране
- `текст` - Директен текст

## Оптимизация

Системата е оптимизирана за ниска консумация на ресурси:

- **Lazy loading** - Данните се зареждат само при нужда
- **Кеширане на embeddings** - Избягва повторни заявки към API
- **Batch операции** - Групиране на embedding заявки
- **Припокриване на сегменти** - Запазва контекст между части

## Конфигурация

### Памет

```typescript
const памет = създайПамет(провайдър, {
  максРезултати: 10, // Максимален брой резултати
  прагНаСходство: 0.7, // Минимално сходство (0-1)
  пътДоБаза: "./.fwm-data", // Път за съхранение
  моделЗаВектори: "auto", // "openai" | "local" | "gemini" | "auto"
  автоИндексиране: true, // Автоматично индексиране
  максДължинаСегмент: 512, // Символи на сегмент
});
```

### Сегментатор

```typescript
const сегментатор = създайСегментатор({
  максДължина: 512, // Максимална дължина на сегмент
  минДължина: 50, // Минимална дължина
  припокриване: 50, // Припокриване между сегменти
  запазиСтруктура: true, // Запазване на структура
});
```

### OCR

```typescript
const скенер = създайСкенер(двигател, {
  език: "bul+eng", // Език за разпознаване
  минУвереност: 0.6, // Минимална увереност
  предобработка: true, // Предобработка на изображение
  мащаб: 1.0, // Мащабиране
  режим: "балансиран", // Режим на работа
});
```

## Статистика

```typescript
// Статистика на паметта
const паметСтат = памет.статистика();
console.log(`Документи: ${паметСтат.общоДокументи}`);
console.log(`Сегменти: ${паметСтат.общоСегменти}`);
console.log(`Памет: ${паметСтат.използванаПамет} MB`);

// Статистика на скенера
const ocrСтат = скенер.статистика();
console.log(`Успеваемост: ${ocrСтат.успеваемост}%`);
console.log(`Средно време: ${ocrСтат.средноВреме} ms`);
```

## Лиценз

MIT
